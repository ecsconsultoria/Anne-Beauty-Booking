<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agendamento Confirmado - Vip & Bella</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container confirmation-page">
    <div class="header">
      <h1>Vip & Bella</h1>
      <p class="tagline">Agendamento Confirmado! âœ…</p>
    </div>

    <div class="confirmation-box" id="confirmationBox">
      <div class="success-icon">âœ…</div>
      <h2>Seu agendamento foi confirmado!</h2>
      <p>VocÃª receberÃ¡ uma mensagem de confirmaÃ§Ã£o via WhatsApp.</p>
      
      <div class="confirmation-details" id="details"></div>

      <div class="actions">
        <a href="https://wa.me/5511961672313" class="btn btn-primary" target="_blank">
          ğŸ’¬ Conversar no WhatsApp
        </a>
        <a href="/client/booking" class="btn btn-secondary">
          ğŸ“… Fazer Novo Agendamento
        </a>
      </div>
    </div>
  </div>

  <script>
    // Obter ID do agendamento da URL
    const appointmentId = '<%= appointmentId %>';
    
    // Buscar detalhes do agendamento
    fetch(`/api/booking/${appointmentId}`)
      .then(res => res.json())
      .then(data => {
        // Formatar data sem problemas de fuso horÃ¡rio
        const [year, month, day] = data.appointment_date.split('-');
        const formattedDate = `${day}/${month}/${year}`;
        
        const detailsHtml = `
          <div class="detail">
            <strong>ğŸ“… Data:</strong> ${formattedDate}
          </div>
          <div class="detail">
            <strong>ğŸ• Hora:</strong> ${data.appointment_time}
          </div>
          <div class="detail">
            <strong>ğŸ’… ServiÃ§o:</strong> ${formatServiceName(data.service)}
          </div>
          <div class="detail">
            <strong>ğŸ‘¤ Nome:</strong> ${data.client_name}
          </div>
          <div class="detail">
            <strong>ğŸ“± Telefone:</strong> ${data.client_phone}
          </div>
        `;
        
        document.getElementById('details').innerHTML = detailsHtml;
      })
      .catch(err => {
        console.error('Erro ao carregar detalhes:', err);
        document.getElementById('details').innerHTML = '<p>Agendamento realizado com sucesso!</p>';
      });

    function formatServiceName(service) {
      const serviceNames = {
        'manicure': 'Manicure',
        'pedicure': 'Pedicure',
        'cilios': 'CÃ­lios',
        'combo_mani_pedi': 'Manicure + Pedicure',
        'combo_completo': 'Manicure + Pedicure + CÃ­lios'
      };
      return serviceNames[service] || service;
    }
  </script>
</body>
</html>
